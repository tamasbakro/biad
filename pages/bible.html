<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblia</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5183890456253667" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .bible-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }

        .bible-sidebar {
            background-color: var(--light-bg);
            padding: 1rem;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .bible-content {
            background-color: var(--light-bg);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .search-box {
            margin-bottom: 1rem;
            display: flex;
        }

        .search-box input {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            flex-grow: 1;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }

        #search-btn {
            background: #fff;
            border: 1px solid #ddd;
            border-left: none;
            cursor: pointer;
            padding: 0 1rem;
            border-top-right-radius: 5px;
            border-bottom-right-radius: 5px;
        }
        #search-btn:hover {
            background: #f7f7f7;
        }

        .lang-switcher {
            display: flex;
            align-items: center;
            margin-left: 2rem;
        }

        .lang-switcher a {
            color: #000000;
            text-decoration: none;
            padding: 0.5rem 0.8rem; 
            border-radius: 5px;
            font-weight: bold;
            border: 1px solid rgba(255, 255, 255, 0.4);
            transition: all 0.3s ease;
        }
        .lang-switcher a:hover {
            background-color: rgba(68, 68, 68, 0.2);
            border-color: #000000;
        }

        .lang-switcher a.active {
            background-color: rgb(from orange r g b);
            border-color: var(--primary-color);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .book-list {
            list-style: none;
            padding: 0;
        }

        .book-section {
            margin: 1rem 0;
        }

        .book-section h4 {
            color: var(--primary-color);
            margin: 0.5rem 0;
            padding: 0.5rem;
            background-color: var(--light-bg);
            border-radius: 5px;
        }

        .book-list li {
            padding: 0.5rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
            border-radius: 3px;
            margin: 0.2rem 0;
        }

        .book-list li:hover {
            background-color: var(--light-bg);
        }

        .book-list li.active {
            background-color: var(--primary-color);
            color: white;
        }

        .chapter-navigation {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .chapter-nav-btn {
            background-color: var(--primary-color);
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .chapter-nav-btn:hover {
            background-color: var(--secondary-color);
        }

        .bible-text {
            line-height: 1.8;
            font-size: 1.1rem;
        }

        .bible-text h2 {
            margin-bottom: 2rem;
            font-size: 1.2rem;
            color: var(--primary-color);
        }

        .bible-text h2 a {
            color: var(--text-color);
            text-decoration: none;
            margin: 0 0.2rem;
        }

        .bible-text h2 a:hover {
            color: var(--primary-color);
        }

        .bible-text h2 .current-chapter {
            color: var(--primary-color);
            font-weight: bold;
        }

        .verses {
            list-style-position: inside;
            padding: 0;
            margin: 0;
        }

        .verses li {
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .verses li a {
            color: var(--text-color);
            text-decoration: none;
        }

        .verses li a[name] {
            font-weight: 500;
        }

        .verses li a:not([name]) {
            font-size: 0.9rem;
            color: var(--primary-color);
        }

        .verses li a:not([name]):hover {
            text-decoration: underline;
        }

        .verse {
            margin-bottom: 1rem;
        }

        .verse-number {
            color: var(--primary-color);
            font-weight: bold;
            margin-right: 0.5rem;
        }

        .search-results {
            margin-top: 1rem;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            max-height: 400px;
            overflow-y: auto;
        }

        .search-results p {
            padding: 1rem;
            text-align: center;
            color: var(--text-color);
        }

        .search-results ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .search-results li {
            padding: 0.8rem 1rem;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .search-results li:last-child {
            border-bottom: none;
        }

        .search-results li:hover {
            background-color: var(--light-bg);
        }

        .search-results li strong {
            color: var(--primary-color);
            display: block;
            margin-bottom: 0.3rem;
        }

        @media (max-width: 768px) {
            .bible-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="hero bible-hero">
        <div class="hero-content">
            <h1 data-translate-key="hero_title_bible">Biblia</h1>
            <p data-translate-key="hero_subtitle_bible">Olvassa online a Bibliát, keressen fejezeteket, és fedezze fel Isten igéjét!</p>
        </div>
    </div>
    <header>
        <nav class="main-nav">
            <div class="logo">
                <a href="../index.html">
                    <img src="../images/logo.png" alt="Adventista Egyház Logó">
                </a>
            </div>
            <ul class="nav-links">
                <li><a href="../index.html" data-translate-key="nav_home">Főoldal</a></li>
                <li><a href="events.html" data-translate-key="nav_events">Események</a></li>
                <li><a href="bible.html" data-translate-key="nav_bible">Biblia</a></li>
                <li><a href="live.html" data-translate-key="nav_live">Élő Közvetítés</a></li>
                <li><a href="gallery.html" data-translate-key="nav_gallery">Galéria</a></li>
                <li><a href="blog.html" data-translate-key="nav_blog">Blog</a></li>
                <li><a href="contact.html" data-translate-key="nav_contact">Kapcsolat</a></li>
                <li><a href="donate.html" class="donate-btn" data-translate-key="nav_donate">Adományozás</a></li>
            </ul>
            <div class="lang-switcher">
                <a href="#" class="lang-btn active" data-lang="hu">HU</a>
                <a href="#" class="lang-btn" data-lang="ro">RO</a>
            </div>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
    </header>

    <main>
        <section class="bible-section">
            <div class="bible-container">
                <div class="bible-sidebar">
                    <div class="search-box">
                        <input type="text" placeholder="Keresés a Bibliában..." data-translate-key="search_placeholder">
                        <button id="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                    <ul class="book-list">
                        <!-- Book list is populated by script -->
                    </ul>
                </div>
                <div class="bible-content">
                    <div class="chapter-navigation">
                        <button class="chapter-nav-btn" data-translate-key="prev_chapter">Előző fejezet</button>
                        <h3></h3>
                        <button class="chapter-nav-btn" data-translate-key="next_chapter">Következő fejezet</button>
                    </div>
                    <div class="bible-text">
                        <h2 data-translate-key="chapters_prefix">Fejezetek: </h2>
                        <ol class="verses">
                            <!-- Verses are populated by script -->
                        </ol>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3 data-translate-key="footer_contact">Kapcsolat</h3>
                <p><i class="fas fa-map-marker-alt"></i> Cím: Str. Mihai Viteazu, Diosig, Bihor, Romania</p>
                <p><i class="fas fa-phone"></i> Telefon: [Telefonszám]</p>
                <p><i class="fas fa-envelope"></i> Email: [Email cím]</p>
            </div>
            <div class="footer-section">
                <h3 data-translate-key="footer_follow">Kövessen minket</h3>
                <div class="social-links">
                    <a href="#"><i class="fab fa-facebook"></i></a>
                    <a href="#"><i class="fab fa-youtube"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p data-translate-key="footer_rights">&copy; 2025 Biserica Adventista Diosig. Minden jog fenntartva.</p>
        </div>
    </footer>

    <script src="../js/main.js"></script>
    <script src="../js/language.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let bibleData;
            let currentLang = localStorage.getItem('language') || 'hu';
            let currentBookIndex = 0;
            let currentChapter = 1;

            const content = {
                hu: {
                    books: ['1Mózes könyve', '2Mózes könyve', '3Mózes könyve', '4Mózes könyve', '5Mózes könyve', 'Józsué könyve', 'Bírák könyve', 'Rút könyve', '1Sámuel könyve', '2Sámuel könyve', '1Királyok könyve', '2Királyok könyve', '1Krónikák könyve', '2Krónikák könyve', 'Ezsdrás könyve', 'Nehemiás könyve', 'Eszter könyve', 'Jób könyve', 'Zsoltárok könyve', 'Példabeszédek könyve', 'Prédikátor könyve', 'Énekek éneke', 'Ézsaiás könyve', 'Jeremiás könyve', 'Jeremiás siralmai', 'Ezékiel könyve', 'Dániel könyve', 'Hóseás könyve', 'Jóel könyve', 'Ámósz könyve', 'Abdiás könyve', 'Jónás könyve', 'Mikeás könyve', 'Náhum könyve', 'Habakuk könyve', 'Zofóniás könyve', 'Haggeus könyve', 'Zakariás könyve', 'Malakiás könyve', 'Máté evangéliuma', 'Márk evangéliuma', 'Lukács evangéliuma', 'János evangéliuma', 'Apostolok Cselekedetei', 'Rómaiakhoz írt levél', '1Korinthusbeliekhez írt levél', '2Korinthusbeliekhez írt levél', 'Galata beliekhez írt levél', 'Efezusbeliekhez írt levél', 'Filippibeliekhez írt levél', 'Kolossébeliekhez írt levél', '1Thessalonikabeliekhez írt levél', '2Thessalonikabeliekhez írt levél', '1Timóteushoz írt levél', '2Timóteushoz írt levél', 'Titushoz írt levél', 'Filemonhoz írt levél', 'Zsidókhoz írt levél', 'Jakab levele', '1Péter levele', '2Péter levele', '1János levele', '2János levele', '3János levele', 'Júdás levele', 'Jelenések könyve']
                },
                ro: {
                    books: ["Geneza", "Exodul", "Leviticul", "Numeri", "Deuteronomul", "Iosua", "Judecători", "Rut", "1 Samuel", "2 Samuel", "1 Împărați", "2 Împărați", "1 Cronici", "2 Cronici", "Ezra", "Neemia", "Estera", "Iov", "Psalmii", "Proverbele", "Eclesiastul", "Cântarea Cântărilor", "Isaia", "Ieremia", "Plângerile lui Ieremia", "Ezechiel", "Daniel", "Osea", "Ioel", "Amos", "Obadia", "Iona", "Mica", "Naum", "Habacuc", "Țefania", "Hagai", "Zaharia", "Maleahi", "Matei", "Marcu", "Luca", "Ioan", "Faptele Apostolilor", "Romani", "1 Corinteni", "2 Corinteni", "Galateni", "Efeseni", "Filipeni", "Coloseni", "1 Tesaloniceni", "2 Tesaloniceni", "1 Timotei", "2 Timotei", "Tit", "Filimon", "Evrei", "Iacov", "1 Petru", "2 Petru", "1 Ioan", "2 Ioan", "3 Ioan", "Iuda", "Apocalipsa"]
                }
            };
            
            const bookList = document.querySelector('.book-list');
            const chapterTitleEl = document.querySelector('.bible-content h3');
            const versesContainer = document.querySelector('.verses');
            const prevChapterBtn = document.querySelector('.chapter-nav-btn:first-child');
            const nextChapterBtn = document.querySelector('.chapter-nav-btn:last-child');
            const chapterLinksContainer = document.querySelector('.bible-text h2');
            const searchInput = document.querySelector('.search-box input');
            const searchBtn = document.getElementById('search-btn');
            const bibleContent = document.querySelector('.bible-content');

            async function initializeBible() {
                const jsonPath = currentLang === 'hu' 
                    ? '../Bible-Database_godlytalias/Hungarian/bible.json' 
                    : '../Bible-Database_godlytalias/Romanian/ro_cornilescu.json';

                try {
                    const response = await fetch(jsonPath);
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    bibleData = await response.json();
                    populateBookList();
                    selectBook(0);
                } catch (error) {
                    console.error('Error loading Bible data:', error);
                    if(chapterTitleEl) chapterTitleEl.textContent = 'Hiba a Biblia betöltésekor.';
                }
            }
            
            function populateBookList() {
                if (!bookList) return;
                bookList.innerHTML = '';
                const currentBooks = content[currentLang].books;

                const otKey = currentLang === 'hu' ? 'ot_header' : 'ot_header';
                const ntKey = currentLang === 'hu' ? 'nt_header' : 'nt_header';


                const otSection = document.createElement('div');
                otSection.className = 'book-section';
                otSection.innerHTML = `<h4 data-translate-key="${otKey}"></h4>`;
                currentBooks.slice(0, 39).forEach((name, index) => {
                    const li = document.createElement('li');
                    li.textContent = name;
                    li.dataset.bookIndex = index;
                    li.addEventListener('click', () => selectBook(index));
                    otSection.appendChild(li);
                });
                bookList.appendChild(otSection);

                const ntSection = document.createElement('div');
                ntSection.className = 'book-section';
                ntSection.innerHTML = `<h4 data-translate-key="${ntKey}"></h4>`;
                currentBooks.slice(39).forEach((name, index) => {
                    const bookIndex = 39 + index;
                    const li = document.createElement('li');
                    li.textContent = name;
                    li.dataset.bookIndex = bookIndex;
                    li.addEventListener('click', () => selectBook(bookIndex));
                    ntSection.appendChild(li);
                });
                bookList.appendChild(ntSection);

                // Manually trigger translation for the newly added headers
                document.querySelectorAll('[data-translate-key]').forEach(el => {
                    const key = el.dataset.translateKey;
                    if (translations[currentLang] && translations[currentLang][key]) {
                        el.innerHTML = translations[currentLang][key];
                    }
                 });
            }
            
            function selectBook(bookIndex) {
                currentBookIndex = bookIndex;
                currentChapter = 1;
                const activeBook = document.querySelector('.book-list li.active');
                if (activeBook) activeBook.classList.remove('active');
                const selectedLi = document.querySelector(`.book-list li[data-book-index='${bookIndex}']`);
                if (selectedLi) selectedLi.classList.add('active');
                loadChapter(currentBookIndex, currentChapter);
            }

            function loadChapter(bookIndex, chapterNum) {
                currentBookIndex = bookIndex;
                currentChapter = chapterNum;

                const bookName = content[currentLang].books[bookIndex];
                let chapter, totalChapters;
                const chapterSuffix = currentLang === 'hu' ? '. fejezet' : '. Capitolul';

                if (currentLang === 'hu') {
                    const book = bibleData.Book[bookIndex];
                    chapter = book.Chapter[chapterNum - 1];
                    totalChapters = book.Chapter.length;
                } else {
                    const book = bibleData[bookIndex];
                    chapter = book.chapters[chapterNum - 1];
                    totalChapters = book.chapters.length;
                }

                if (chapterTitleEl) {
                    chapterTitleEl.textContent = `${bookName} - ${chapterNum}${chapterSuffix}`;
                }

                if (versesContainer) {
                    versesContainer.innerHTML = '';
                    if (currentLang === 'hu') {
                        if (chapter && chapter.Verse) {
                            chapter.Verse.forEach(verse => {
                                const li = document.createElement('li');
                                li.textContent = verse.Verse;
                                versesContainer.appendChild(li);
                            });
                        }
                    } else { // Romanian
                        if (chapter) {
                            chapter.forEach(verseText => {
                                const li = document.createElement('li');
                                li.textContent = verseText;
                                versesContainer.appendChild(li);
                            });
                        }
                    }
                }
                
                if (prevChapterBtn) prevChapterBtn.disabled = chapterNum === 1;
                if (nextChapterBtn) nextChapterBtn.disabled = chapterNum === totalChapters;
                updateChapterLinks(bookIndex, chapterNum, totalChapters);
            }

            function updateChapterLinks(bookIndex, currentChap, totalChapters) {
                if (!chapterLinksContainer) return;
                const prefix = currentLang === 'hu' ? 'Fejezetek: ' : 'Capitole: ';
                chapterLinksContainer.innerHTML = prefix;
                for (let i = 1; i <= totalChapters; i++) {
                    const link = document.createElement('a');
                    link.href = '#';
                    link.textContent = i;
                    if (i === currentChap) link.classList.add('current-chapter');
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        loadChapter(bookIndex, i);
                    });
                    chapterLinksContainer.appendChild(link);
                    if (i < totalChapters) chapterLinksContainer.appendChild(document.createTextNode(', '));
                }
            }

            const performSearch = () => {
                const searchTerm = searchInput.value.trim();
                if (searchTerm.length < 2) return;
                displaySearchLoading();
                setTimeout(() => searchBible(searchTerm), 10);
            };

            if (searchBtn) searchBtn.addEventListener('click', performSearch);
            if (searchInput) searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') { e.preventDefault(); performSearch(); }
            });

            function searchBible(term) {
                const results = [];
                const lowerCaseTerm = term.toLowerCase();

                if (currentLang === 'hu') {
                    bibleData.Book.forEach((book, bookIndex) => {
                        book.Chapter.forEach((chapter, chapterIndex) => {
                            chapter.Verse.forEach((verse, verseIndex) => {
                                if (verse.Verse.toLowerCase().includes(lowerCaseTerm)) {
                                    results.push({ bookIndex, bookName: content.hu.books[bookIndex], chapter: chapterIndex + 1, verseNumber: verseIndex + 1, verseText: verse.Verse });
                                }
                            });
                        });
                    });
                } else { // Romanian
                     bibleData.forEach((book, bookIndex) => {
                        book.chapters.forEach((chapter, chapterIndex) => {
                            chapter.forEach((verseText, verseIndex) => {
                                if (verseText.toLowerCase().includes(lowerCaseTerm)) {
                                    results.push({ bookIndex, bookName: content.ro.books[bookIndex], chapter: chapterIndex + 1, verseNumber: verseIndex + 1, verseText: verseText });
                                }
                            });
                        });
                    });
                }
                displaySearchResults(results, term);
            }

            function displaySearchResults(results, term) {
                clearSearchResults();
                hideChapterContent();
                let resultsContainer = document.querySelector('.bible-content .search-results') || document.createElement('div');
                resultsContainer.className = 'search-results';
                resultsContainer.style.display = 'block';
                if (!resultsContainer.parentElement) {
                    bibleContent.prepend(resultsContainer);
                }
                const noResultsText = currentLang === 'hu' ? 'Nincs találat' : 'Niciun rezultat';
                if (results.length === 0) {
                    resultsContainer.innerHTML = `<p>${noResultsText}</p>`;
                } else {
                    const list = document.createElement('ul');
                    results.forEach(res => {
                        const item = document.createElement('li');
                        item.innerHTML = `<strong>${res.bookName} ${res.chapter}:${res.verseNumber}</strong><br>${res.verseText.replace(new RegExp(term, 'gi'), '<b>$&</b>')}`;
                        item.addEventListener('click', () => {
                            selectBook(res.bookIndex);
                            loadChapter(res.bookIndex, res.chapter);
                            clearSearchResults();
                        });
                        list.appendChild(item);
                    });
                    resultsContainer.innerHTML = '';
                    resultsContainer.appendChild(list);
                }
            }

            function clearSearchResults() {
                 const resultsContainer = document.querySelector('.bible-content .search-results');
                 if (resultsContainer) {
                     resultsContainer.innerHTML = '';
                     resultsContainer.style.display = 'none';
                 }
                 showChapterContent();
            }

            function hideChapterContent() {
                const chapterContent = document.querySelector('.bible-text');
                const nav = document.querySelector('.chapter-navigation');
                if (chapterContent) chapterContent.style.display = 'none';
                if (nav) nav.style.display = 'none';
            }

            function showChapterContent() {
                const chapterContent = document.querySelector('.bible-text');
                const nav = document.querySelector('.chapter-navigation');
                if (chapterContent) chapterContent.style.display = 'block';
                if (nav) nav.style.display = 'flex';
            }
            
            function displaySearchLoading() {
                 clearSearchResults();
                 hideChapterContent();
                 let resultsContainer = document.querySelector('.bible-content .search-results') || document.createElement('div');
                 resultsContainer.className = 'search-results';
                 resultsContainer.style.display = 'block';
                 if (!resultsContainer.parentElement) {
                    bibleContent.prepend(resultsContainer);
                 }
                 const searchingText = currentLang === 'hu' ? 'Keresés folyamatban...' : 'Se caută...';
                 resultsContainer.innerHTML = `<p>${searchingText}</p>`;
            }

            initializeBible();
        });
    </script>
</body>
</html> 